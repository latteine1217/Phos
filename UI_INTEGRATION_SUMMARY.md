# Phos v0.2.0 - Physical Mode UI æ•´åˆç¸½çµ

**å®Œæˆæ—¥æœŸ**: 2025-12-19  
**ç‰ˆæœ¬**: v0.2.0 (UI Integration)  
**ç‹€æ…‹**: âœ… æ ¸å¿ƒ UI å®Œæˆï¼Œå¾…ç”¨æˆ¶æ¸¬è©¦

---

## ğŸ“‹ å¯¦ä½œç¸½çµ

### âœ… å·²å®Œæˆé …ç›®

#### 1. å´é‚Šæ¬„æ–°å¢ã€Œæ¸²æŸ“æ¨¡å¼ã€å€æ®µ
**ä½ç½®**: `Phos_0.2.0.py` Line ~1276-1295

```python
physics_mode_choice = st.radio(
    "é¸æ“‡æ¸²æŸ“æ¨¡å¼",
    ["Artisticï¼ˆè—è¡“ï¼‰", "Physicalï¼ˆç‰©ç†ï¼‰", "Hybridï¼ˆæ··åˆï¼‰"],
    ...
)
```

**ç‰¹æ€§**:
- âœ… ä¸‰ç¨®æ¨¡å¼é¸æ“‡ï¼ˆArtistic/Physical/Hybridï¼‰
- âœ… å³æ™‚é¡¯ç¤ºæ¨¡å¼èªªæ˜
- âœ… é è¨­ Artistic æ¨¡å¼ï¼ˆå‘å¾Œç›¸å®¹ï¼‰

---

#### 2. ç‰©ç†åƒæ•¸èª¿æ•´å€ï¼ˆæ¢ä»¶é¡¯ç¤ºï¼‰
**ä½ç½®**: `Phos_0.2.0.py` Line ~1310-1478

åƒ…åœ¨ Physical æˆ– Hybrid æ¨¡å¼ä¸‹é¡¯ç¤ºï¼ŒåŒ…å« 3 å€‹ Expanderï¼š

##### ğŸ“Š Bloomï¼ˆå…‰æšˆï¼‰åƒæ•¸
- **Mode**: artistic / physical (Radio)
- **Threshold**: 0.5-0.95 (Slider, step=0.05)
- **Scattering Ratio**: 0.05-0.30 (Slider, step=0.05, physical only)
- **é è¨­**: physical mode, threshold=0.8, scattering=0.1

##### ğŸ“ˆ H&D æ›²ç·šåƒæ•¸
- **Enable**: Checkbox (é è¨­ Physical æ¨¡å¼é–‹å•Ÿ)
- **Gamma**: 0.50-2.00 (Slider, step=0.05, é è¨­=0.65)
- **Toe Strength**: 0.5-5.0 (Slider, step=0.5, é è¨­=2.0)
- **Shoulder Strength**: 0.5-3.0 (Slider, step=0.5, é è¨­=1.5)

##### ğŸ² é¡†ç²’åƒæ•¸
- **Mode**: artistic / poisson (Radio)
- **Grain Size**: 0.5-3.5 Î¼m (Slider, step=0.5, é è¨­=1.5)
- **Intensity**: 0.0-2.0 (Slider, step=0.1, é è¨­=0.8)

---

#### 3. process_image() å‡½æ•¸æ›´æ–°
**ä½ç½®**: `Phos_0.2.0.py` Line ~1143-1248

**æ–°å¢åƒæ•¸**: `physics_params: Optional[dict]`

åŒ…å«æ¬„ä½:
- `physics_mode`: PhysicsMode enum
- `bloom_mode`, `bloom_threshold`, `bloom_scattering_ratio`
- `hd_enabled`, `hd_gamma`, `hd_toe_strength`, `hd_shoulder_strength`
- `grain_mode`, `grain_size`, `grain_intensity`

**é‚è¼¯**:
```python
if physics_params:
    film.physics_mode = physics_params['physics_mode']
    film.bloom_params.mode = physics_params['bloom_mode']
    # ... æ‡‰ç”¨å…¶ä»–åƒæ•¸
```

---

#### 4. å–®å¼µè™•ç†æ¨¡å¼æ•´åˆ
**ä½ç½®**: `Phos_0.2.0.py` Line ~1513-1533

```python
# æº–å‚™ç‰©ç†åƒæ•¸å­—å…¸
physics_params = {
    'physics_mode': physics_mode,
    'bloom_mode': bloom_mode,
    # ... æ‰€æœ‰ UI åƒæ•¸
}

# å‚³éçµ¦è™•ç†å‡½æ•¸
film_image, process_time, output_path = process_image(
    uploaded_image, film_type, grain_style, tone_style, physics_params
)
```

**è¼¸å‡ºæª”åæ›´æ–°**:
- èˆŠï¼š`phos_nc200_20251219_123456.jpg`
- æ–°ï¼š`phos_nc200_physical_20251219_123456.jpg` (å«æ¨¡å¼å¾Œç¶´)

**æˆåŠŸè¨Šæ¯æ›´æ–°**:
- èˆŠï¼šã€Œåº•ç‰‡é¡¯å½±å¥½äº†ï¼Œç”¨æ™‚ 0.85ç§’ã€
- æ–°ï¼šã€Œâœ¨ åº•ç‰‡é¡¯å½±å¥½äº†ï¼ç”¨æ™‚ 0.85ç§’ | æ¨¡å¼: PHYSICALã€

---

## ğŸ¯ UI è¨­è¨ˆåŸå‰‡

### 1. ç°¡æ½”å„ªå…ˆ (Simplicity First)
- **é è¨­éš±è—**ï¼šArtistic æ¨¡å¼ä¸é¡¯ç¤ºé€²éšåƒæ•¸
- **æ¼¸é€²æ­éœ²**ï¼šPhysical/Hybrid æ‰é¡¯ç¤ºåƒæ•¸å€æ®µ
- **Expander æŠ˜ç–Š**ï¼š3 å€‹åƒæ•¸å€é è¨­æŠ˜ç–Šï¼Œé¿å…å£“è¿«æ„Ÿ

### 2. å‘å¾Œç›¸å®¹ (Backward Compatibility)
- **é è¨­è¡Œç‚ºä¸è®Š**ï¼šé è¨­ Artistic æ¨¡å¼
- **æ—¢æœ‰ç”¨æˆ¶ç„¡æ„Ÿ**ï¼šä¸æ”¹è®Šç¾æœ‰å·¥ä½œæµç¨‹
- **å¯é¸æ€§**ï¼šæ‰€æœ‰æ–°åŠŸèƒ½éƒ½æ˜¯ã€Œopt-inã€

### 3. å³æ™‚å›é¥‹ (Immediate Feedback)
- **æ¨¡å¼èªªæ˜**ï¼šåˆ‡æ›æ¨¡å¼å³æ™‚é¡¯ç¤ºç‰¹æ€§èªªæ˜
- **åƒæ•¸ Caption**ï¼šæ¯å€‹ Expander åº•éƒ¨é¡¯ç¤ºç•¶å‰å€¼
- **Help Tooltip**ï¼šæ‰€æœ‰åƒæ•¸éƒ½æœ‰è©³ç´°èªªæ˜

### 4. ä¸€è‡´æ€§ (Consistency)
- **é…è‰²æ²¿ç”¨**ï¼šä¿æŒåŸæœ‰çŠç‘šç´…ä¸»é¡Œ
- **å…ƒä»¶çµ±ä¸€**ï¼šSliderã€Radioã€Checkbox é¢¨æ ¼ä¸€è‡´
- **é–“è·ç³»çµ±**ï¼š`st.divider()` åˆ†éš”å„å€æ®µ

---

## ğŸ“Š UI çµæ§‹

```
å´é‚Šæ¬„ (Sidebar)
â”œâ”€â”€ æ¨™é¡Œå€
â”‚   â”œâ”€â”€ Phos.
â”‚   â”œâ”€â”€ è¨ˆç®—å…‰å­¸èƒ¶ç‰‡æ¨¡æ‹Ÿ
â”‚   â””â”€â”€ v0.2.0 Â· Batch Processing
â”œâ”€â”€ ---
â”œâ”€â”€ ğŸ“· è™•ç†æ¨¡å¼
â”‚   â””â”€â”€ Radio: å–®å¼µ / æ‰¹é‡
â”œâ”€â”€ ---
â”œâ”€â”€ ğŸï¸ èƒ¶ç‰‡è¨­å®š
â”‚   â”œâ”€â”€ èƒ¶ç‰‡é¡å‹é¸æ“‡ (Selectbox)
â”‚   â”œâ”€â”€ èƒ¶ç‰‡é¡†ç²’åº¦ (Selectbox)
â”‚   â””â”€â”€ æ›²ç·šæ˜ å°„ (Selectbox)
â”œâ”€â”€ ---
â”œâ”€â”€ âœ¨ æ¸²æŸ“æ¨¡å¼ (NEW)
â”‚   â”œâ”€â”€ Radio: Artistic / Physical / Hybrid
â”‚   â””â”€â”€ Info: æ¨¡å¼èªªæ˜
â”œâ”€â”€ [æ¢ä»¶é¡¯ç¤º] âš™ï¸ ç‰©ç†åƒæ•¸ (NEW)
â”‚   â”œâ”€â”€ ---
â”‚   â”œâ”€â”€ ğŸ“Š Bloomï¼ˆå…‰æšˆï¼‰åƒæ•¸ (Expander)
â”‚   â”‚   â”œâ”€â”€ Mode (Radio)
â”‚   â”‚   â”œâ”€â”€ Threshold (Slider)
â”‚   â”‚   â””â”€â”€ Scattering Ratio (Slider, conditional)
â”‚   â”œâ”€â”€ ğŸ“ˆ H&D æ›²ç·šåƒæ•¸ (Expander)
â”‚   â”‚   â”œâ”€â”€ Enable (Checkbox)
â”‚   â”‚   â”œâ”€â”€ Gamma (Slider, conditional)
â”‚   â”‚   â”œâ”€â”€ Toe Strength (Slider, conditional)
â”‚   â”‚   â””â”€â”€ Shoulder Strength (Slider, conditional)
â”‚   â””â”€â”€ ğŸ² é¡†ç²’åƒæ•¸ (Expander)
â”‚       â”œâ”€â”€ Mode (Radio)
â”‚       â”œâ”€â”€ Grain Size (Slider)
â”‚       â””â”€â”€ Intensity (Slider)
â”œâ”€â”€ ---
â””â”€â”€ æ–‡ä»¶ä¸Šå‚³å™¨ (File Uploader)
```

---

## ğŸ§ª æ¸¬è©¦æŒ‡å—

### å¿«é€Ÿé©—è­‰æ­¥é©Ÿ

#### 1. å•Ÿå‹•æ‡‰ç”¨
```bash
cd /Users/latteine/Documents/coding/Phos
streamlit run Phos_0.2.0.py
```

#### 2. Artistic æ¨¡å¼æ¸¬è©¦ï¼ˆé è¨­ï¼‰
- [x] å´é‚Šæ¬„é¡¯ç¤ºã€Œâœ¨ æ¸²æŸ“æ¨¡å¼ã€
- [x] é è¨­é¸ä¸­ã€ŒArtisticï¼ˆè—è¡“ï¼‰ã€
- [x] é¡¯ç¤ºã€ŒğŸ¨ **è—è¡“æ¨¡å¼**: ...ã€
- [x] **ä¸é¡¯ç¤º**ã€Œâš™ï¸ ç‰©ç†åƒæ•¸ã€å€æ®µ
- [ ] ä¸Šå‚³æ¸¬è©¦åœ–ç‰‡ï¼Œç¢ºèªè™•ç†æˆåŠŸ
- [ ] æª¢æŸ¥è¼¸å‡ºæª”åï¼š`phos_nc200_artistic_*.jpg`

#### 3. Physical æ¨¡å¼æ¸¬è©¦
- [x] é¸æ“‡ã€ŒPhysicalï¼ˆç‰©ç†ï¼‰ã€
- [x] é¡¯ç¤ºã€ŒğŸ”¬ **ç‰©ç†æ¨¡å¼**: ...ã€
- [x] **é¡¯ç¤º**ã€Œâš™ï¸ ç‰©ç†åƒæ•¸ã€å€æ®µ
- [x] 3 å€‹ Expander å¯æ­£å¸¸å±•é–‹/æŠ˜ç–Š
- [ ] ä¸Šå‚³æ¸¬è©¦åœ–ç‰‡ï¼Œç¢ºèªè™•ç†æˆåŠŸ
- [ ] æª¢æŸ¥è¼¸å‡ºæª”åï¼š`phos_nc200_physical_*.jpg`
- [ ] æª¢æŸ¥æˆåŠŸè¨Šæ¯ï¼šã€Œ... | æ¨¡å¼: PHYSICALã€

#### 4. Hybrid æ¨¡å¼æ¸¬è©¦
- [x] é¸æ“‡ã€ŒHybridï¼ˆæ··åˆï¼‰ã€
- [x] é¡¯ç¤ºã€Œâš™ï¸ **æ··åˆæ¨¡å¼**: ...ã€
- [x] ç‰©ç†åƒæ•¸å€æ®µé¡¯ç¤º
- [ ] æ··åˆé…ç½®æ¸¬è©¦ï¼š
  - Bloom mode: artistic
  - H&D curve: enabled, gamma=0.5
  - Grain mode: poisson, size=2.5
- [ ] ç¢ºèªè™•ç†æˆåŠŸ

#### 5. åƒæ•¸èª¿æ•´éŸ¿æ‡‰æ¸¬è©¦
- [ ] **Bloom Threshold**: 0.7 â†’ é«˜å…‰æ›´å¤š
- [ ] **Bloom Scattering**: 0.2 â†’ å…‰æšˆæ›´æ˜é¡¯
- [ ] **H&D Gamma**: 0.5 â†’ æŸ”å’Œä½å°æ¯”
- [ ] **H&D Gamma**: 1.8 â†’ é®®è‰·é«˜å°æ¯”
- [ ] **Grain Size**: 0.5 â†’ ç´°è†©
- [ ] **Grain Size**: 3.0 â†’ ç²—ç³™

#### 6. èªæ³•æª¢æŸ¥
```bash
python3 -m py_compile Phos_0.2.0.py
# æ‡‰ç„¡è¼¸å‡ºï¼ˆâœ… å·²é€šéï¼‰
```

---

## ğŸ“ˆ æ•ˆèƒ½é æœŸ

| æ¨¡å¼ | é æœŸè™•ç†æ™‚é–“ (2000Ã—3000) | é–‹éŠ· |
|-----|------------------------|-----|
| Artistic | ~0.7s | åŸºæº– |
| Physical | ~0.8s | +8% |
| Hybrid | 0.7-0.8s | ä¾é…ç½® |

---

## âš ï¸ å·²çŸ¥é™åˆ¶

### 1. æ‰¹é‡è™•ç†å°šæœªæ•´åˆ
**ç‹€æ…‹**: â³ å¾…å¯¦ä½œ

**åŸå› **: æ‰¹é‡è™•ç†ä½¿ç”¨ç¨ç«‹çš„ `batch_process_func()`ï¼Œéœ€é¡å¤–å‚³éåƒæ•¸

**å½±éŸ¿**: æ‰¹é‡æ¨¡å¼ä¸‹åƒ…èƒ½ä½¿ç”¨ Artistic æ¨¡å¼

**è¨ˆç•«**: v0.2.1 æˆ–å¾ŒçºŒç‰ˆæœ¬

### 2. åƒæ•¸é è¨­é›†ï¼ˆPresetsï¼‰
**ç‹€æ…‹**: æœªå¯¦ä½œ

**å»ºè­°åŠŸèƒ½**:
- é è¨­é›†é¸æ“‡ï¼šã€Œç´°è†©ã€ã€ã€Œå¹³è¡¡ã€ã€ã€Œå¼·çƒˆã€
- ä¸€éµæ‡‰ç”¨åƒæ•¸çµ„åˆ
- è‡ªè¨‚é è¨­é›†å„²å­˜

**å„ªå…ˆç´š**: P2 (Nice to have)

### 3. å³æ™‚é è¦½ï¼ˆLive Previewï¼‰
**ç‹€æ…‹**: æœªå¯¦ä½œ

**æŒ‘æˆ°**: Streamlit å–®åŸ·è¡Œç·’é™åˆ¶ï¼Œé›£ä»¥å¯¦ç¾çœŸæ­£çš„ã€Œå³æ™‚ã€é è¦½

**æ›¿ä»£æ–¹æ¡ˆ**: æä¾›ã€Œå¿«é€Ÿé è¦½ã€æŒ‰éˆ•ï¼ˆä½è§£æåº¦è™•ç†ï¼‰

**å„ªå…ˆç´š**: P3 (Future)

---

## ğŸ“ ç¨‹å¼ç¢¼ä¿®æ”¹ç¸½çµ

| æª”æ¡ˆ | æ–°å¢è¡Œæ•¸ | ä¿®æ”¹è¡Œæ•¸ | ä¸»è¦è®Šæ›´ |
|-----|---------|---------|---------|
| `Phos_0.2.0.py` | ~210 | ~20 | UI å€æ®µ + process_image æ›´æ–° |

**ç¸½è¨ˆ**: +~210 è¡Œï¼ˆUI ç›¸é—œç¨‹å¼ç¢¼ï¼‰

---

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### åƒæ•¸å‚³éæµç¨‹

```
UI (Sidebar)
    â†“ (st.radio, st.slider, st.checkbox)
physics_params = {...}  # å­—å…¸æ‰“åŒ…
    â†“
process_image(..., physics_params)
    â†“ (åƒæ•¸è§£åŒ…)
film.physics_mode = ...
film.bloom_params.* = ...
film.hd_curve_params.* = ...
film.grain_params.* = ...
    â†“
spectral_response(image, film)  # ä½¿ç”¨ä¿®æ”¹å¾Œçš„ film
    â†“
optical_processing(..., film)  # æ‡‰ç”¨ç‰©ç†æ¨¡å¼
    â†“
final_image (çµæœ)
```

### æ¢ä»¶é¡¯ç¤ºé‚è¼¯

```python
if physics_mode in [PhysicsMode.PHYSICAL, PhysicsMode.HYBRID]:
    st.markdown("### âš™ï¸ ç‰©ç†åƒæ•¸")
    with st.expander("ğŸ“Š Bloomï¼ˆå…‰æšˆï¼‰åƒæ•¸"):
        # ... åƒæ•¸æ»‘æ¡¿
    # ... å…¶ä»– Expander
else:
    # Artistic æ¨¡å¼ï¼šä½¿ç”¨é è¨­å€¼ï¼ˆä¸é¡¯ç¤º UIï¼‰
    bloom_mode = "artistic"
    # ...
```

### é è¨­å€¼ç­–ç•¥

| æ¨¡å¼ | Bloom | H&D Curve | Grain |
|-----|-------|-----------|-------|
| Artistic | artistic, ç„¡ UI | disabled | artistic, ç„¡ UI |
| Physical | **physical**, æœ‰ UI | **enabled**, æœ‰ UI | **poisson**, æœ‰ UI |
| Hybrid | ä¾ UI é¸æ“‡ | ä¾ UI é¸æ“‡ | ä¾ UI é¸æ“‡ |

---

## ğŸš€ ä¸‹ä¸€æ­¥è¨ˆç•«

### v0.2.1 (çŸ­æœŸ)
- [ ] **æ‰¹é‡è™•ç†æ•´åˆ**: æ”¯æ´ Physical Mode
- [ ] **åƒæ•¸é è¨­é›†**: æä¾›å¸¸ç”¨çµ„åˆï¼ˆç´°è†©/å¹³è¡¡/å¼·çƒˆï¼‰
- [ ] **è¦–è¦ºå°æ¯”**: Artistic vs Physical å³æ™‚å°æ¯”ï¼ˆSide-by-sideï¼‰

### v0.3.0 (ä¸­æœŸ)
- [ ] **åƒæ•¸åŒ¯å…¥/åŒ¯å‡º**: YAML/JSON é…ç½®æª”æ¡ˆ
- [ ] **å¿«é€Ÿé è¦½**: ä½è§£æåº¦å³æ™‚é è¦½
- [ ] **æ­·å²è¨˜éŒ„**: å„²å­˜è™•ç†éçš„åƒæ•¸çµ„åˆ

### v0.4.0 (é•·æœŸ)
- [ ] **é€²éšæ¨¡å¼**: æ›´å¤šç‰©ç†åƒæ•¸ï¼ˆHalationã€äº’æ˜“å¾‹å¤±æ•ˆï¼‰
- [ ] **æ‰¹é‡é è¨­**: æ¯å¼µç…§ç‰‡ç¨ç«‹åƒæ•¸
- [ ] **CLI å·¥å…·**: å‘½ä»¤åˆ—æ‰¹æ¬¡è™•ç†

---

## ğŸ“š ç›¸é—œæ–‡æª”

- **ç‰©ç†æ¨¡å¼æŒ‡å—**: `PHYSICAL_MODE_GUIDE.md` (~800 lines)
- **ç‰©ç†å¯©æŸ¥å ±å‘Š**: `PHYSICS_REVIEW.md` (30 pages)
- **æ±ºç­–æ—¥èªŒ**: `context/decisions_log.md` (Decision #001-#011)
- **æ¸¬è©¦å ±å‘Š**: `tests/` (26/26 tests passed)

---

## âœ… æª¢æŸ¥æ¸…å–®

### å¯¦ä½œå®Œæˆåº¦
- [x] Physics Mode é¸æ“‡å™¨ (Radio)
- [x] Bloom åƒæ•¸èª¿æ•´ (Expander + Sliders)
- [x] H&D æ›²ç·šåƒæ•¸èª¿æ•´ (Expander + Sliders)
- [x] Grain åƒæ•¸èª¿æ•´ (Expander + Sliders)
- [x] process_image() å‡½æ•¸æ›´æ–°
- [x] å–®å¼µè™•ç†æ¨¡å¼æ•´åˆ
- [ ] æ‰¹é‡è™•ç†æ¨¡å¼æ•´åˆ â³
- [x] èªæ³•æª¢æŸ¥é€šé
- [ ] ä½¿ç”¨è€…æ¸¬è©¦ â³

### æ–‡æª”å®Œæˆåº¦
- [x] UI æ•´åˆç¸½çµæ–‡æª”
- [x] æ¸¬è©¦æŒ‡å—
- [ ] æ±ºç­–æ—¥èªŒæ›´æ–° â³
- [ ] README.md æ›´æ–° â³

### æ¸¬è©¦å®Œæˆåº¦
- [ ] Artistic æ¨¡å¼åŠŸèƒ½æ¸¬è©¦
- [ ] Physical æ¨¡å¼åŠŸèƒ½æ¸¬è©¦
- [ ] Hybrid æ¨¡å¼åŠŸèƒ½æ¸¬è©¦
- [ ] åƒæ•¸èª¿æ•´éŸ¿æ‡‰æ¸¬è©¦
- [ ] è¼¸å‡ºæª”åé©—è­‰
- [ ] æ•ˆèƒ½åŸºæº–æ¸¬è©¦

---

**æ–‡æª”ç¶­è­·**: @LYCO6273  
**æœ€å¾Œæ›´æ–°**: 2025-12-19  
**ç‹€æ…‹**: âœ… æ ¸å¿ƒ UI å®Œæˆï¼Œâ³ å¾…ç”¨æˆ¶æ¸¬è©¦èˆ‡æ‰¹é‡æ¨¡å¼æ•´åˆ
